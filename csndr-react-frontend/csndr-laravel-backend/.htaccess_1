<IfModule mod_rewrite.c>
    # Désactiver l'accès aux dossiers
    Options -Indexes
    
    # Activer le suivi des liens symboliques
    Options +FollowSymLinks
    
    # Activer le moteur de réécriture
    RewriteEngine On

    # Définir la base de réécriture
    RewriteBase /backend/

    # Ne pas réécrire les requêtes pour les fichiers et dossiers existants
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    
    # Gestion du préfixe /public
    RewriteCond %{REQUEST_URI} !^/public/
    
    # Rediriger toutes les requêtes vers le dossier public
    RewriteRule ^(.*)$ public/$1 [L]
    
    # Gestion des requêtes OPTIONS pour CORS
    RewriteCond %{REQUEST_METHOD} OPTIONS
    RewriteRule ^(.*)$ $1 [R=200,L]
</IfModule>

# Sécurité - Désactiver l'accès aux fichiers sensibles
<FilesMatch "^\.env|composer\.json|composer\.lock|package\.json|webpack\.mix\.js$|phpunit\.xml|\.gitignore|\.gitattributes$">
    Order allow,deny
    Deny from all
</FilesMatch>
